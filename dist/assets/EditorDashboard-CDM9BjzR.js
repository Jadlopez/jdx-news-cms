import{m as y,r as a,j as e}from"./index-D7F0MAQ-.js";import{g as E,h as C,f as S}from"./newsService-DiONljKG.js";import{N as R}from"./NewsList-CM2royf-.js";function A(){const{userData:k}=y(),[x,p]=a.useState([]),[o,f]=a.useState("Todos"),[j,c]=a.useState(!1),[d,u]=a.useState(null),[i,N]=a.useState(""),[b,g]=a.useState(0),h=a.useCallback(async()=>{c(!0),u(null);try{const s=await E(o==="Todos"?null:o);p(Array.isArray(s)?s:[])}catch(s){console.error("Error cargando noticias:",s),u("No se pudieron cargar las noticias. Inténtalo de nuevo.")}finally{c(!1)}},[o]);a.useEffect(()=>{h()},[h,b]);const l=()=>g(s=>s+1),w=async(s,t)=>{if(window.confirm(`¿Confirmas cambiar el estado a "${t}"?`))try{await C(s,t),l()}catch(r){console.error("Error actualizando estado:",r),alert("No se pudo cambiar el estado. Revisa la consola.")}},v=async(s,t)=>{if(window.confirm("¿Eliminar la noticia? Esta acción no se puede deshacer."))try{await S(s,t),l()}catch(r){console.error("Error eliminando noticia:",r),alert("No se pudo eliminar la noticia.")}},m=x.filter(s=>{if(!i)return!0;const t=i.trim().toLowerCase(),n=(s.title||s.titulo||"").toString().toLowerCase(),r=(s.subtitle||s.subtitulo||"").toString().toLowerCase();return n.includes(t)||r.includes(t)});return e.jsxs("div",{className:"editor-dashboard p-6",children:[e.jsxs("div",{className:"editor-header mb-4",children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Panel del Editor"}),e.jsx("p",{className:"text-muted",children:"Revisa, publica o desactiva noticias creadas por los reporteros."})]}),e.jsxs("div",{className:"editor-controls mb-4",children:[e.jsxs("div",{className:"control-group",children:[e.jsx("label",{htmlFor:"filter",children:"Filtrar por estado:"}),e.jsxs("select",{id:"filter",value:o,onChange:s=>f(s.target.value),className:"control-select","aria-label":"Filtrar noticias por estado",children:[e.jsx("option",{children:"Todos"}),e.jsx("option",{children:"Edición"}),e.jsx("option",{children:"Terminado"}),e.jsx("option",{children:"Publicado"}),e.jsx("option",{children:"Desactivado"})]}),e.jsx("button",{onClick:l,className:"control-btn","aria-label":"Refrescar listado",children:"Refrescar"})]}),e.jsxs("div",{className:"control-group",children:[e.jsx("label",{htmlFor:"search",className:"sr-only",children:"Buscar"}),e.jsx("input",{id:"search",value:i,onChange:s=>N(s.target.value),placeholder:"Buscar por título o bajante...",className:"control-input","aria-label":"Buscar noticias"})]})]}),d&&e.jsx("div",{className:"editor-error",role:"alert",children:d}),j?e.jsx("div",{className:"editor-loading",children:"Cargando noticias…"}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"editor-list-meta mb-3",children:e.jsxs("small",{children:[m.length," resultado(s)"]})}),e.jsx(R,{news:m,onReload:l,onChangeStatus:w,onDelete:v})]})]})}export{A as default};
